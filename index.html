<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Connexion</title>
  </head>
  <body>
    <p>Test9</p>
    <script>
      var DEVELOPER_KEY = "AIzaSyCRv7YN1ir8poSE4YPhEF4EHXXP81TylPQ";
      var clientId =
        "693075473121-hvag2o7vtvkd6ig8qujcpt7n9h14fsv2.apps.googleusercontent.com";
      var appId = "693075473121";
      var scope = [
      "https://www.googleapis.com/auth/drive",
      "https://www.googleapis.com/auth/spreadsheets",
      "https://www.googleapis.com/auth/script.container.ui",
      "https://www.googleapis.com/auth/userinfo.email",
      "https://www.googleapis.com/auth/spreadsheets"
      
    ];
      let oauthToken;

      // Use the Google API Loader script to load the google.picker script.
      function loadPicker() {
        gapi.load("auth", { callback: onAuthApiLoad });
        // gapi.load("picker", { callback: onPickerApiLoad });
      }

      function onAuthApiLoad() {
        window.gapi.auth.authorize(
          {
            client_id: clientId,
            scope: scope,
            immediate: false,
          },
          handleAuthResult
        );
      }

      function onPickerApiLoad() {
        // pickerApiLoaded = true;
        // createPicker();
      }

      function handleAuthResult(authResult) {
        if (authResult && !authResult.error) {
          oauthToken = authResult.access_token;
          window.opener.postMessage({'oauthToken': oauthToken}, '*');
        //   createPicker();
        }
      }
    </script>
    <script src="https://apis.google.com/js/api.js?onload=loadPicker"></script>
  </body>
</html>
